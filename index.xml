<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Alston&#39;s Blog on Alston&#39;s Blog</title>
    <link>https://alston.top/</link>
    <description>Recent content in Alston&#39;s Blog on Alston&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Mon, 28 Jan 2019 21:27:25 +0800</lastBuildDate>
    <atom:link href="/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>EXCEL高级排序和匹配方法</title>
      <link>https://alston.top/2019/excel%E9%AB%98%E7%BA%A7%E6%8E%92%E5%BA%8F%E5%92%8C%E5%8C%B9%E9%85%8D%E6%96%B9%E6%B3%95/</link>
      <pubDate>Mon, 28 Jan 2019 21:27:25 +0800</pubDate>
      
      <guid>https://alston.top/2019/excel%E9%AB%98%E7%BA%A7%E6%8E%92%E5%BA%8F%E5%92%8C%E5%8C%B9%E9%85%8D%E6%96%B9%E6%B3%95/</guid>
      <description>

&lt;p&gt;最近有一个任务涉及到比较复杂的EXCEL操作，虽然对EXCEL函数不是很熟悉，但是又想用单个公式解决，所以花了很长时间才解决。成就感十足，特此记录，免得以后忘了。&lt;/p&gt;

&lt;h2 id=&#34;任务描述&#34;&gt;任务描述&lt;/h2&gt;

&lt;p&gt;原始任务更复杂一点，出于隐私和简化目的，用一个简单的例子来代替。如图：&lt;br /&gt;
&lt;img src=&#34;https://s2.ax1x.com/2019/01/28/kMiwtI.png&#34; alt=&#34;EXCEL任务&#34; /&gt;&lt;br /&gt;
左边每一行有惟一的学生ID、所在班别、评判标准、语数英成绩；右边每一行一样，包含了所有的学生信息。现在想根据每个学生的评判标准计算出该学生在班里的排名，比如学生ID为1的学生，计算他的语文成绩在甲班中的排名。&lt;/p&gt;

&lt;h2 id=&#34;需要用到的函数&#34;&gt;需要用到的函数&lt;/h2&gt;

&lt;h3 id=&#34;rank&#34;&gt;rank&lt;/h3&gt;

&lt;p&gt;EXCEL中排序最简单的函数就是用&lt;code&gt;rank&lt;/code&gt;函数了，用法是&lt;code&gt;=rank(num, array,order)&lt;/code&gt;，其中&lt;code&gt;num&lt;/code&gt;是要排名的数值，&lt;code&gt;array&lt;/code&gt;是要排名的序列，&lt;code&gt;order&lt;/code&gt;表示升、降序，默认为0（降序），要升序则设为1。这里需要注意是&lt;code&gt;num&lt;/code&gt;并且在&lt;code&gt;array&lt;/code&gt;中，否则结果为&lt;code&gt;#N/A&lt;/code&gt;。&lt;br /&gt;
&lt;br/&gt;&lt;br /&gt;
但是在遇到条件排序时用&lt;code&gt;rank&lt;/code&gt;就不够了，这时候可以用&lt;code&gt;sumproduct&lt;/code&gt;进行排序。&lt;/p&gt;

&lt;h3 id=&#34;sumproduct&#34;&gt;sumproduct&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;sumproduct&lt;/code&gt;，顾名思义，表示“乘积之和”，即数学定义中的“内积”，用法是&lt;code&gt;=sumproduct(array1, array2, ...)&lt;/code&gt;，参数必须是相同维度的范围，EXCEL会计算相应位置的数字乘积，然后加总得出结果。&lt;/p&gt;

&lt;p&gt;&lt;code&gt;sumproduct&lt;/code&gt;用法有很多，这里我们用它来进行排序，从而得到带有条件判断的排序（这里还用到了EXCEL对序列的计算特性，了解就好）。比如要求第1到第11个学生的语文成绩在各自班级中的排名，公式如下：&lt;/p&gt;

&lt;p&gt;&lt;code&gt;=sumproduct(($J$2:$J$21 = B2) * ($L$2:$L$2 &amp;gt; D2)) + 1&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;上式中的&lt;code&gt;&amp;gt;&lt;/code&gt;号可以根据需求改成&lt;code&gt;&amp;gt;=&lt;/code&gt;、&lt;code&gt;&amp;lt;=&lt;/code&gt;、&lt;code&gt;&amp;lt;&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;需要注意的是，很多人可能会觉得中间的乘号&lt;code&gt;*&lt;/code&gt;可以改成逗号&lt;code&gt;,&lt;/code&gt;，这是不对的。因为&lt;code&gt;($J$2:$J$21 = B2)&lt;/code&gt;和&lt;code&gt;($L$2:$L$2 &amp;gt; D2)&lt;/code&gt;是两个逻辑序列，互相独立的两个逻辑数据之间不能进行对应位置处逻辑值相乘。&lt;/p&gt;

&lt;h3 id=&#34;match&#34;&gt;match&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;match&lt;/code&gt;用于匹配指定值在指定序列中的位置，用法是&lt;code&gt;=match(num, array, type)&lt;/code&gt;，其中&lt;code&gt;num&lt;/code&gt;为要匹配的内容，&lt;code&gt;array&lt;/code&gt;为要匹配的序列，&lt;code&gt;type&lt;/code&gt;为指定的查询方式，取值为-1,0,1，定义如下：&lt;br /&gt;
|type|说明|&lt;br /&gt;
|:&amp;mdash;:|:&amp;mdash;:|&lt;br /&gt;
|1/省略|查找&lt;strong&gt;小于或等于&lt;/strong&gt;指定内容的&lt;strong&gt;最大值&lt;/strong&gt;，而且指定区域必须按&lt;strong&gt;升序&lt;/strong&gt;排列|&lt;br /&gt;
|0|查找&lt;strong&gt;等于&lt;/strong&gt;指定内容的&lt;strong&gt;第一个&lt;/strong&gt;数值|&lt;br /&gt;
|-1|查找&lt;strong&gt;大于或等于&lt;/strong&gt;指定内容的&lt;strong&gt;最小值&lt;/strong&gt;，而且指定内容必须按&lt;strong&gt;降序&lt;/strong&gt;排列|&lt;/p&gt;

&lt;h3 id=&#34;address&#34;&gt;address&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;address&lt;/code&gt;用于根据指定行号和列号获得单元格地址，用法是&lt;code&gt;=address(row_num, column_num, [abs_num], [a1], [sheet_text])&lt;/code&gt;。其中&lt;code&gt;abs_num&lt;/code&gt;表示返回的单元格地址格式，取值为1到4，定义如下：&lt;br /&gt;
|abs_num|说明|&lt;br /&gt;
|:&amp;mdash;:|:&amp;mdash;:|&lt;br /&gt;
|1/省略|绝对地址，如&amp;rdquo;$A$1&amp;rdquo;|&lt;br /&gt;
|2|绝对行号，相对列标，如&amp;rdquo;A$1&amp;rdquo;|&lt;br /&gt;
|3|相对行号，绝对列标，如&amp;rdquo;$A1&amp;rdquo;|&lt;br /&gt;
|4|相对地址，如&amp;rdquo;A1&amp;rdquo;|&lt;br /&gt;
&lt;code&gt;a1&lt;/code&gt;表示返回的单元格样式，取值为1或者省略时，返回A1样式（如上表举例）；取值为0时返回R1C1样式，如&lt;code&gt;R[1]C[1]&lt;/code&gt;。&lt;br /&gt;
&lt;code&gt;sheet_text&lt;/code&gt;表示表名，相当于在返回值前面加上&lt;code&gt;sheet_text!&lt;/code&gt;引用。&lt;/p&gt;

&lt;h3 id=&#34;indirect&#34;&gt;indirect&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;indirect&lt;/code&gt;返回由文本字符串指定的引用，用法比较简单，&lt;code&gt;=indirect(ref_text, a1)&lt;/code&gt;。&lt;br /&gt;
其中&lt;code&gt;ref_text&lt;/code&gt;是要引用的文本，&lt;code&gt;a1&lt;/code&gt;为单元格样式与上面定义一致。比如&lt;code&gt;indirect(&amp;quot;A1&amp;quot;)&lt;/code&gt;则返回&lt;code&gt;A1&lt;/code&gt;单元格的内容。&lt;/p&gt;

&lt;h2 id=&#34;解决问题&#34;&gt;解决问题&lt;/h2&gt;

&lt;p&gt;搞清楚需要用到的函数后，就可以着手解决问题了。我们的任务是根据每个学生的评判标准计算出该学生在班里的排名，比如学生ID为1的学生，计算他的语文成绩在甲班中的排名。以&lt;code&gt;G2&lt;/code&gt;单元格为例：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;首先，要求在甲班中的排名，所以用&lt;code&gt;sumproduct&lt;/code&gt;：&lt;br /&gt;
&lt;code&gt;=sumproduct(($J:$J = B2)*???) + 1&lt;/code&gt;，问号是需要动态变化的，我们想要的是每个学生对应的评判标准对应的列，比如说第一个学生的评判标准是语文，则问号对应的是&lt;code&gt;($L:$L &amp;gt; D2)&lt;/code&gt;。&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;获得动态的评判标准所在列的列标：&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;先用&lt;code&gt;match&lt;/code&gt;得到对应的行、列号：&lt;code&gt;match(C2, $1:$1)&lt;/code&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;再用&lt;code&gt;address&lt;/code&gt;得到对应的行号、列标：&lt;code&gt;address(1, match(C2,$1:$1), 4&lt;/code&gt;，注意这里的1是固定的，因为我们从第一行里去匹配；4可以省略也可以换成1、2、3，对结果不造成影响。&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;因为我们只需要用到列标，所以用&lt;code&gt;left&lt;/code&gt;取列标：&lt;code&gt;left(address(1,match(C2,$1:$1), 4), len(address(1,match(C2,$1:$1),4))-1)&lt;/code&gt;，如果能确定列标只有一个字母的话，&lt;code&gt;len&lt;/code&gt;那一串可以直接换成1。&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;最后再用&lt;code&gt;indirect&lt;/code&gt;取对应单元格的内容：&lt;code&gt;indirect(left(address(1,match(C2,$1:$1), 4), len(address(1,match(C2,$1:$1),4))-1) &amp;amp; &amp;quot;:&amp;quot; &amp;amp; left(address(1,match(C2,$1:$1), 4), len(address(1,match(C2,$1:$1),4))-1))&lt;/code&gt;，用这一坨代替前面的三个问号就可以了。&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;后记&#34;&gt;后记&lt;/h2&gt;

&lt;p&gt;拆开后其实还是挺简单的，如果不嫌麻烦、对excel函数又比较熟悉的话，很快就可以做出来了。手工做的话，就得先按班排序，然后再把语数英三门成绩分开排序，最后再计算排名，还是比较烦琐且容易出错的。&lt;/p&gt;

&lt;h2 id=&#34;参考链接&#34;&gt;参考链接&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://baijiahao.baidu.com/s?id=1571397722910063&amp;amp;wfr=spider&amp;amp;for=pc&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;SUMPRODUCT函数注意事项：乘号与逗号有区别&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://support.office.com/zh-cn/article/ADDRESS-%E5%87%BD%E6%95%B0-D0C26C0D-3991-446B-8DE4-AB46431D4F89&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;ADDRESS函数&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://support.office.com/zh-cn/article/INDIRECT-%E5%87%BD%E6%95%B0-474b3a3a-8a26-4f44-b491-92b6306fa261&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;INDIRECT函数&lt;/a&gt;&lt;br /&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>中证征信第一天</title>
      <link>https://alston.top/2019/first-day-in-chinacscs/</link>
      <pubDate>Mon, 14 Jan 2019 21:51:13 +0800</pubDate>
      
      <guid>https://alston.top/2019/first-day-in-chinacscs/</guid>
      <description>

&lt;p&gt;结束第一份工作，今天入职中证征信（大企业部解决方案助理），也算是开始一段新的旅途了。&lt;/p&gt;

&lt;p&gt;新人新气象，今天不光是我上班的第一天，还是我把博客搭好的第一天&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;。虽然很对不起某位同学，说好了第一篇博文要写篇&lt;strong&gt;IT桔子爬虫教程&lt;/strong&gt;&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;的，但是第一篇博文还是献给我的工作，也作为一个日志系统，不定期记录一下工作中的见闻和理解吧。&lt;/p&gt;

&lt;h2 id=&#34;入职&#34;&gt;入职&lt;/h2&gt;

&lt;p&gt;上午办入职手续，这个时候才想到要问五险一金的缴纳比例和基数，在此奉劝各位签约前&lt;strong&gt;一定要问清待遇的组成、五险一金的缴纳基数和缴纳比例&lt;/strong&gt;。&lt;/p&gt;

&lt;p&gt;入职手续还算是比较简单，HR小姐姐人很好，领我见了几个同事，正式签约后会帮忙领一套文具和一台电脑。电脑配置花了很长时间，而且居然是旧电脑23333&lt;/p&gt;

&lt;p&gt;不能忍，更不能忍的是居然还设了管理员权限！安装个软件都得管理员登录，非常麻烦。下午的时候向管理员申请新电脑，希望能早日给到我吧。。。&lt;/p&gt;

&lt;p&gt;办完入职手续就直接去项目了。同事们都很热情，中午吃饭还带上了我。看得出来工作氛围还是比较轻松的。吃完饭下午回到项目，大家也开始进入工作。我初来乍到，也就先熟悉熟悉材料，旁听一下他们讨论了。&lt;/p&gt;

&lt;h2 id=&#34;工作记录-总结&#34;&gt;工作记录&amp;amp;总结&lt;/h2&gt;

&lt;p&gt;今天会想起写这么一篇文章，主要还是想总结一下看材料和旁听的时候发现的一些新名词吧。&lt;/p&gt;

&lt;p&gt;中证征信做的是内部信用评级——为银行、券商资管提供评级产品、风险预警、市面上难拿到的数据等。&lt;strong&gt;咨询（解决方案）这一块需要用到的知识还挺复合的，需要了解打分卡等常用的信用评级模型、统计/计量知识等，还需要了解数据库的操作（mysql之类的），模型的实现用R，当然也可以用python或者其他语言。&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;下面两个名词是新接触的，敞口是跟常见定义不同，清单什么的也做一下备注。&lt;/p&gt;

&lt;dl&gt;
&lt;dt&gt;敞口&lt;br /&gt;&lt;/dt&gt;
&lt;dd&gt;很奇怪，一般敞口都是指存在风险的部分以及受风险影响的程度，在这里居然指的企业所在行业。当然跟行业划分又有点不一样，准确定义应该是&lt;strong&gt;综合考虑了一系列业务特征之后的企业分组&lt;/strong&gt;。&lt;br /&gt;
&lt;br /&gt;&lt;/dd&gt;
&lt;dt&gt;超长清单、长清单、短清单、入模指标&lt;br /&gt;&lt;/dt&gt;
&lt;dd&gt;清单的意思就是指标list，这里日常交流说的跟文档里的有点区别：&lt;br /&gt;&lt;/dd&gt;
&lt;dd&gt;1. 文档里是通过企业分析得到超长清单→通过数据清洗得到长清单→通过单变量分析、多变量分析、穷举建模等得到短清单→加上综合因素得出基础评级结果；&lt;br /&gt;&lt;/dd&gt;
&lt;dd&gt;2. 日常交流中使用的术语则是通过企业分析、数据清洗得到长清单→通过单变量分析、多变量分析等得到短清单→通过穷举建模、专家讨论等得到入模指标→加上综合因素得出基础评级结果。&lt;br /&gt;
&lt;br /&gt;&lt;/dd&gt;
&lt;/dl&gt;

&lt;h2 id=&#34;新的开始-新的期望&#34;&gt;新的开始，新的期望&lt;/h2&gt;

&lt;p&gt;结束在高沣资本的FA生涯来中证征信，也算是彻彻底底的转行了，但愿我能快点适应新工作，快点掌握工作内容吧！业余时间还得花点心思复习FRM，目标今年把FRM考下来！&lt;/p&gt;
&lt;div class=&#34;footnotes&#34;&gt;

&lt;hr /&gt;

&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;本博客采用&lt;a href=&#34;https://gohugo.io&#34; rel=&#34;nofollow noreferrer&#34; target=&#34;_blank&#34;&gt;Hugo&lt;/a&gt;搭建，搭建过程找时间再单独开篇博客。&lt;br /&gt;
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:1&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;我会找时间写的，I Promise!&lt;br /&gt;
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:2&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;找时间总结一下中证征信的业务介绍。&lt;br /&gt;
 &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:3&#34;&gt;&lt;sup&gt;[return]&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>